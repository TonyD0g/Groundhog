package org.sec.Constant;

import org.sec.Crypt.random;
import org.sec.Network.Socket;
import org.sec.utils.FileUtils;
import org.sec.utils.stringUtils;

import java.io.*;
import java.nio.charset.StandardCharsets;
import java.util.List;

/**
 * 存放一些基础配置
 */
public class configuration {
    // 单例模式,将只需要一次加载的数据填入该函数中
    private configuration() throws IOException {
        ThreadId = Integer.parseInt(stringUtils.getRandomString("0123456789", 4));
        choiceVersion = random.randomVersion();
        correctUserInfo = "." + File.separator + "correctUserInfo.txt";
        File filename1 = new File(configuration.correctUserInfo);
        if (!filename1.exists()) {
            filename1.createNewFile();
        }

        File filename2 = new File("." + File.separator + "wantReadList.txt");
        if (!filename2.exists()) {
            filename2.createNewFile();
        }

        File filename3 = new File("." + File.separator + "blockIpList.txt");
        if (!filename3.exists()) {
            filename3.createNewFile();
        }
        FileUtils.flushFile("." + File.separator + "blockIpList.txt"); // 刷新blockIp.txt

        File logFolder = new File("." + File.separator + "logFolder");
        if (!logFolder.exists()) {
            logFolder.mkdirs();
        }

        // 操作日志.log
        currentTime = stringUtils.thisTime(timeFormat);
        logFileName = "." + File.separator + "logFolder" + File.separator + currentTime + ".log";
        File filename4 = new File(logFileName);
        if (!filename4.exists()) {
            filename4.createNewFile();
        }
        // 建"getData"文件夹,之后获取的数据都存放进去
        File folder = new File("getData");
        if (!folder.exists()) {
            folder.mkdir();
        }
    }

    public static configuration getInstance() throws IOException {
        if (instanceThreadId == null) {
            instanceThreadId = new configuration();
        }
        return instanceThreadId;
    }

    public static boolean closeCheck = false;

    public static String currentTime;
    public static String timeFormat = "yyyy-MM-dd";

    public static String logFileName;
    private static configuration instanceThreadId;
    // 蜜罐开放的端口
    public static int PORT = 3306;

    // 初始化时生成随机ThreadId,并记录住
    public static int ThreadId;

    // 蜜罐想要读取的文件
    public static List<String> wantReadList;

    // 记录随机生成的salt
    public static String randomSaltValue;

    // 创建 userInfo.txt 文件,里面保存着账号和密码,使用空格进行分割
    public static String correctUserInfo;

    // 验证信息
    public static byte[] verificationText = {0x07, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00};

    public static String selectVersion = "73656c65637420404076657273696f6e5f636f6d6d656e74206c696d69742031";
    public static String showVariable = "53484f57205641524941424c4553";
    public static String showVariablesRes1 = "01000001025200000203646566001173657373696f6e5f7661726961626c65731173657373696f6e5f7661726961626c65730d5661726961626c655f6e616d650d5661726961626c655f6e616d650c080040000000fd01100000004200000303646566001173657373696f6e5f7661726961626c65731173657373696f6e5f7661726961626c65730556616c75650556616c75650c080000040000fd000000000005000004fe000022001b000005186175746f5f696e6372656d656e745f696e6372656d656e74013118000006156175746f5f696e6372656d656e745f6f666673657401310e0000070a6175746f636f6d6d6974024f4e1b000008176175746f6d617469635f73705f70726976696c65676573024f4e1b0000091661766f69645f74656d706f72616c5f75706772616465034f46460c00000a086261636b5f6c6f670235323000000b076261736564697227443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c0f00000c0a6269675f7461626c6573034f46460f00000d0c62696e645f61646472657373012a1800000e1162696e6c6f675f63616368655f73697a650533323736381600000f0f62696e6c6f675f636865636b73756d0543524333322c0000102762696e6c6f675f6469726563745f6e6f6e5f7472616e73616374696f6e616c5f75706461746573034f4646210000111362696e6c6f675f6572726f725f616374696f6e0c41424f52545f534552564552120000120d62696e6c6f675f666f726d617403524f57210000131e62696e6c6f675f67726f75705f636f6d6d69745f73796e635f64656c617901302a0000142762696e6c6f675f67726f75705f636f6d6d69745f73796e635f6e6f5f64656c61795f636f756e7401301f0000151b62696e6c6f675f677469645f73696d706c655f7265636f76657279024f4e1e0000161b62696e6c6f675f6d61785f666c7573685f71756575655f74696d650130180000171462696e6c6f675f6f726465725f636f6d6d697473024f4e160000181062696e6c6f675f726f775f696d6167650446554c4c210000191c62696e6c6f675f726f77735f71756572795f6c6f675f6576656e7473034f46461d00001a1662696e6c6f675f73746d745f63616368655f73697a650533323736383100001b2a62696e6c6f675f7472616e73616374696f6e5f646570656e64656e63795f686973746f72795f73697a650532353030303400001c2662696e6c6f675f7472616e73616374696f6e5f646570656e64656e63795f747261636b696e670c434f4d4d49545f4f524445522200001d15626c6f636b5f656e6372797074696f6e5f6d6f64650b6165732d3132382d6563622000001e1762756c6b5f696e736572745f6275666665725f73697a6507383338383630381c00001f146368617261637465725f7365745f636c69656e74066c6174696e3120000020186368617261637465725f7365745f636f6e6e656374696f6e066c6174696e311c000021166368617261637465725f7365745f6461746162617365047574663820000022186368617261637465725f7365745f66696c6573797374656d0662696e6172791d000023156368617261637465725f7365745f726573756c7473066c6174696e311a000024146368617261637465725f7365745f73657276657204757466381a000025146368617261637465725f7365745f73797374656d04757466384a000026126368617261637465725f736574735f64697236443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c73686172655c63686172736574735c1600002711636865636b5f70726f78795f7573657273034f46462700002814636f6c6c6174696f6e5f636f6e6e656374696f6e116c6174696e315f737765646973685f63692300002912636f6c6c6174696f6e5f64617461626173650f757466385f67656e6572616c5f63692100002a10636f6c6c6174696f6e5f7365727665720f757466385f67656e6572616c5f63691900002b0f636f6d706c6574696f6e5f74797065084e4f5f434841494e1700002c11636f6e63757272656e745f696e73657274044155544f1300002d0f636f6e6e6563745f74696d656f75740231300e00002e09636f72655f66696c65034f46463500002f07646174616469722c443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c150000300b646174655f666f726d61740825592d256d2d2564220000310f6461746574696d655f666f726d61741125592d256d2d25642025483a25693a2573340000321d64656661756c745f61757468656e7469636174696f6e5f706c7567696e156d7973716c5f6e61746976655f70617373776f72641c0000331964656661756c745f70617373776f72645f6c69666574696d6501301e0000341664656661756c745f73746f726167655f656e67696e65064d794953414d220000351a64656661756c745f746d705f73746f726167655f656e67696e6506496e6e6f4442160000361364656661756c745f7765656b5f666f726d61740130130000370f64656c61795f6b65795f7772697465024f4e190000381464656c617965645f696e736572745f6c696d6974033130301b0000391664656c617965645f696e736572745f74696d656f7574033330301800003a1264656c617965645f71756575655f73697a6504313030301a00003b1864697361626c65645f73746f726167655f656e67696e6573002200003c1e646973636f6e6e6563745f6f6e5f657870697265645f70617373776f7264024f4e1a00003d176469765f707265636973696f6e5f696e6372656d656e7401341800003e13656e645f6d61726b6572735f696e5f6a736f6e034f46461d00003f18656e666f7263655f677469645f636f6e73697374656e6379034f46461e0000401965715f72616e67655f696e6465785f646976655f6c696d6974033230300e0000410b6572726f725f636f756e740130140000420f6576656e745f7363686564756c6572034f464613000043106578706972655f6c6f67735f646179730130240000441f6578706c696369745f64656661756c74735f666f725f74696d657374616d70034f46460f0000450d65787465726e616c5f75736572000a00004605666c757368034f46460d0000470a666c7573685f74696d6501301600004812666f726569676e5f6b65795f636865636b73024f4e210000491166745f626f6f6c65616e5f73796e7461780e2b202d3e3c28297e2a3a2222267c1300004a0f66745f6d61785f776f72645f6c656e0238341200004b0f66745f6d696e5f776f72645f6c656e01341c00004c1866745f71756572795f657870616e73696f6e5f6c696d69740232301c00004d1066745f73746f70776f72645f66696c650a286275696c742d696e291000004e0b67656e6572616c5f6c6f67034f46465100004f1067656e6572616c5f6c6f675f66696c653f443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362e6c6f671a0000501467726f75705f636f6e6361745f6d61785f6c656e04313032342600005120677469645f65786563757465645f636f6d7072657373696f6e5f706572696f6404313030300e00005209677469645f6d6f6465034f46461400005309677469645f6e657874094155544f4d415449430c0000540a677469645f6f776e6564000d0000550b677469645f70757267656400120000560d686176655f636f6d7072657373035945530e0000570a686176655f6372797074024e4f1900005814686176655f64796e616d69635f6c6f6164696e6703594553120000590d686176655f67656f6d65747279035945531600005a0c686176655f6f70656e73736c0844495341424c45441300005b0e686176655f70726f66696c696e67035945531500005c10686176655f71756572795f6361636865035945531400005d0f686176655f72747265655f6b657973035945531200005e08686176655f73736c0844495341424c45441b00005f16686176655f73746174656d656e745f74696d656f757403594553110000600c686176655f73796d6c696e6b03594553140000610f686f73745f63616368655f73697a65033133381900006208686f73746e616d650f4445534b544f502d4f37324e5439360b000063086964656e7469747901301a0000641569676e6f72655f6275696c74696e5f696e6e6f6462034f4646100000650e69676e6f72655f64625f64697273000e0000660c696e69745f636f6e6e656374000b00006709696e69745f66696c65000c0000680a696e69745f736c617665001c00006918696e6e6f64625f61646170746976655f666c757368696e67024f4e2000006a1c696e6e6f64625f61646170746976655f666c757368696e675f6c776d0231301e00006b1a696e6e6f64625f61646170746976655f686173685f696e646578024f4e2300006c20696e6e6f64625f61646170746976655f686173685f696e6465785f706172747301382700006d1f696e6e6f64625f61646170746976655f6d61785f736c6565705f64656c6179063135303030302000006e1d696e6e6f64625f6170695f626b5f636f6d6d69745f696e74657276616c01351f00006f1a696e6e6f64625f6170695f64697361626c655f726f776c6f636b034f46461d00007018696e6e6f64625f6170695f656e61626c655f62696e6c6f67034f46461a00007115696e6e6f64625f6170695f656e61626c655f6d646c034f46461700007214696e6e6f64625f6170695f7472785f6c6576656c01301f0000731b696e6e6f64625f6175746f657874656e645f696e6372656d656e740236341b00007418696e6e6f64625f6175746f696e635f6c6f636b5f6d6f64650131280000751d696e6e6f64625f6275666665725f706f6f6c5f6368756e6b5f73697a65093133343231373732382700007623696e6e6f64625f6275666665725f706f6f6c5f64756d705f61745f73687574646f776e024f4e200000771b696e6e6f64625f6275666665725f706f6f6c5f64756d705f6e6f77034f46461f0000781b696e6e6f64625f6275666665725f706f6f6c5f64756d705f7063740232352b0000791b696e6e6f64625f6275666665725f706f6f6c5f66696c656e616d650e69625f6275666665725f706f6f6c1f00007a1c696e6e6f64625f6275666665725f706f6f6c5f696e7374616e63657301312200007b1d696e6e6f64625f6275666665725f706f6f6c5f6c6f61645f61626f7274034f46462600007c22696e6e6f64625f6275666665725f706f6f6c5f6c6f61645f61745f73746172747570024f4e2000007d1b696e6e6f64625f6275666665725f706f6f6c5f6c6f61645f6e6f77034f46462200007e17696e6e6f64625f6275666665725f706f6f6c5f73697a65093133343231373732382100007f1d696e6e6f64625f6368616e67655f6275666665725f6d61785f73697a650232351c00008017696e6e6f64625f6368616e67655f627566666572696e6703616c6c2000008119696e6e6f64625f636865636b73756d5f616c676f726974686d0563726333321400008210696e6e6f64625f636865636b73756d73024f4e210000831c696e6e6f64625f636d705f7065725f696e6465785f656e61626c6564034f46461c00008419696e6e6f64625f636f6d6d69745f636f6e63757272656e637901302b00008528696e6e6f64625f636f6d7072657373696f6e5f6661696c7572655f7468726573686f6c645f70637401351b00008618696e6e6f64625f636f6d7072657373696f6e5f6c6576656c0136220000871e696e6e6f64625f636f6d7072657373696f6e5f7061645f7063745f6d6178023530200000881a696e6e6f64625f636f6e63757272656e63795f7469636b65747304353030302d00008915696e6e6f64625f646174615f66696c655f7061746816696264617461313a31324d3a6175746f657874656e641600008a14696e6e6f64625f646174615f686f6d655f646972001a00008b16696e6e6f64625f646561646c6f636b5f646574656374024f4e2200008c19696e6e6f64625f64656661756c745f726f775f666f726d61740764796e616d69632300008d1e696e6e6f64625f64697361626c655f736f72745f66696c655f6361636865034f46461600008e12696e6e6f64625f646f75626c657772697465024f4e1700008f14696e6e6f64625f666173745f73687574646f776e01311d00009012696e6e6f64625f66696c655f666f726d6174094261727261637564611c00009118696e6e6f64625f66696c655f666f726d61745f636865636b024f4e2100009216696e6e6f64625f66696c655f666f726d61745f6d6178094261727261637564611900009315696e6e6f64625f66696c655f7065725f7461626c65024f4e1700009412696e6e6f64625f66696c6c5f666163746f72033130301e0000951b696e6e6f64625f666c7573685f6c6f675f61745f74696d656f75740131210000961e696e6e6f64625f666c7573685f6c6f675f61745f7472785f636f6d6d697401311500009713696e6e6f64625f666c7573685f6d6574686f64001900009816696e6e6f64625f666c7573685f6e65696768626f727301311500009911696e6e6f64625f666c7573685f73796e63024f4e1d00009a19696e6e6f64625f666c757368696e675f6176675f6c6f6f70730233302000009b1b696e6e6f64625f666f7263655f6c6f61645f636f72727570746564034f46461800009c15696e6e6f64625f666f7263655f7265636f7665727901301500009d13696e6e6f64625f66745f6175785f7461626c65001d00009e14696e6e6f64625f66745f63616368655f73697a6507383030303030302000009f1b696e6e6f64625f66745f656e61626c655f646961675f7072696e74034f46461d0000a019696e6e6f64625f66745f656e61626c655f73746f70776f7264024f4e1c0000a118696e6e6f64625f66745f6d61785f746f6b656e5f73697a650238341b0000a218696e6e6f64625f66745f6d696e5f746f6b656e5f73697a650133210000a31b696e6e6f64625f66745f6e756d5f776f72645f6f7074696d697a650432303030280000a41c696e6e6f64625f66745f726573756c745f63616368655f6c696d69740a32303030303030303030210000a51f696e6e6f64625f66745f7365727665725f73746f70776f72645f7461626c65001c0000a619696e6e6f64625f66745f736f72745f706c6c5f6465677265650132250000a71a696e6e6f64625f66745f746f74616c5f63616368655f73697a65093634303030303030301f0000a81d696e6e6f64625f66745f757365725f73746f70776f72645f7461626c6500170000a912696e6e6f64625f696f5f6361706163697479033230301c0000aa16696e6e6f64625f696f5f63617061636974795f6d61780432303030170000ab13696e6e6f64625f6c617267655f707265666978024f4e1c0000ac18696e6e6f64625f6c6f636b5f776169745f74696d656f7574023530230000ad1e696e6e6f64625f6c6f636b735f756e736166655f666f725f62696e6c6f67034f4646200000ae16696e6e6f64625f6c6f675f6275666665725f73697a65083136373737323136180000af14696e6e6f64625f6c6f675f636865636b73756d73024f4e1f0000b01b696e6e6f64625f6c6f675f636f6d707265737365645f7061676573024f4e1e0000b114696e6e6f64625f6c6f675f66696c655f73697a650835303333313634381c0000b219696e6e6f64625f6c6f675f66696c65735f696e5f67726f757001321d0000b319696e6e6f64625f6c6f675f67726f75705f686f6d655f646972022e5c210000b41b696e6e6f64625f6c6f675f77726974655f61686561645f73697a6504383139321b0000b515696e6e6f64625f6c72755f7363616e5f64657074680431303234250000b61a696e6e6f64625f6d61785f64697274795f70616765735f7063740937352e303030303030280000b71e696e6e6f64625f6d61785f64697274795f70616765735f7063745f6c776d08302e303030303030170000b814696e6e6f64625f6d61785f70757267655f6c616701301d0000b91a696e6e6f64625f6d61785f70757267655f6c61675f64656c61790130240000ba18696e6e6f64625f6d61785f756e646f5f6c6f675f73697a650a31303733373431383234180000bb16696e6e6f64625f6d6f6e69746f725f64697361626c6500170000bc15696e6e6f64625f6d6f6e69746f725f656e61626c6500160000bd14696e6e6f64625f6d6f6e69746f725f7265736574001a0000be18696e6e6f64625f6d6f6e69746f725f72657365745f616c6c00190000bf15696e6e6f64625f6f6c645f626c6f636b735f7063740233371c0000c016696e6e6f64625f6f6c645f626c6f636b735f74696d6504313030302b0000c120696e6e6f64625f6f6e6c696e655f616c7465725f6c6f675f6d61785f73697a6509313334323137373238170000c211696e6e6f64625f6f70656e5f66696c65730432303030220000c31d696e6e6f64625f6f7074696d697a655f66756c6c746578745f6f6e6c79034f4646170000c414696e6e6f64625f706167655f636c65616e6572730131170000c510696e6e6f64625f706167655f73697a650531363338341f0000c61a696e6e6f64625f7072696e745f616c6c5f646561646c6f636b73034f46461c0000c717696e6e6f64625f70757267655f62617463685f73697a6503333030290000c824696e6e6f64625f70757267655f727365675f7472756e636174655f6672657175656e637903313238170000c914696e6e6f64625f70757267655f7468726561647301341d0000ca18696e6e6f64625f72616e646f6d5f726561645f6168656164034f46461f0000cb1b696e6e6f64625f726561645f61686561645f7468726573686f6c64023536190000cc16696e6e6f64625f726561645f696f5f746872656164730134150000cd10696e6e6f64625f726561645f6f6e6c79034f46461b0000ce18696e6e6f64625f7265706c69636174696f6e5f64656c617901301f0000cf1a696e6e6f64625f726f6c6c6261636b5f6f6e5f74696d656f7574034f46461d0000d018696e6e6f64625f726f6c6c6261636b5f7365676d656e747303313238200000d117696e6e6f64625f736f72745f6275666665725f73697a650731303438353736190000d216696e6e6f64625f7370696e5f776169745f64656c617901361c0000d318696e6e6f64625f73746174735f6175746f5f726563616c63024f4e270000d422696e6e6f64625f73746174735f696e636c7564655f64656c6574655f6d61726b6564034f4646200000d513696e6e6f64625f73746174735f6d6574686f640b6e756c6c735f657175616c1d0000d618696e6e6f64625f73746174735f6f6e5f6d65746164617461034f46461b0000d717696e6e6f64625f73746174735f70657273697374656e74024f4e280000d824696e6e6f64625f73746174735f70657273697374656e745f73616d706c655f70616765730232301c0000d919696e6e6f64625f73746174735f73616d706c655f70616765730138260000da23696e6e6f64625f73746174735f7472616e7369656e745f73616d706c655f70616765730138190000db14696e6e6f64625f7374617475735f6f7574707574034f46461f0000dc1a696e6e6f64625f7374617475735f6f75747075745f6c6f636b73034f4646160000dd12696e6e6f64625f7374726963745f6d6f6465024f4e150000de11696e6e6f64625f737570706f72745f7861024f4e190000df16696e6e6f64625f73796e635f61727261795f73697a6501311a0000e016696e6e6f64625f73796e635f7370696e5f6c6f6f7073023330160000e112696e6e6f64625f7461626c655f6c6f636b73024f4e310000e21a696e6e6f64625f74656d705f646174615f66696c655f70617468156962746d70313a31324d3a6175746f657874656e641c0000e319696e6e6f64625f7468726561645f636f6e63757272656e63790130200000e419696e6e6f64625f7468726561645f736c6565705f64656c61790531303030300f0000e50d696e6e6f64625f746d7064697200190000e615696e6e6f64625f756e646f5f6469726563746f7279022e5c1d0000e718696e6e6f64625f756e646f5f6c6f675f7472756e63617465034f4646150000e810696e6e6f64625f756e646f5f6c6f6773033132381a0000e917696e6e6f64625f756e646f5f7461626c657370616365730130190000ea15696e6e6f64625f7573655f6e61746976655f61696f024f4e160000eb0e696e6e6f64625f76657273696f6e06352e372e32361a0000ec17696e6e6f64625f77726974655f696f5f7468726561647301340c0000ed09696e736572745f696401301a0000ee13696e7465726163746976655f74696d656f7574053238383030280000ef20696e7465726e616c5f746d705f6469736b5f73746f726167655f656e67696e6506496e6e6f4442180000f0106a6f696e5f6275666665725f73697a6506323632313434190000f1146b6565705f66696c65735f6f6e5f637265617465034f4646180000f20f6b65795f6275666665725f73697a6507383338383630381c0000f3176b65795f63616368655f6167655f7468726573686f6c64033330301a0000f4146b65795f63616368655f626c6f636b5f73697a6504313032341d0000f5186b65795f63616368655f6469766973696f6e5f6c696d697403313030160000f6126b657972696e675f6f7065726174696f6e73024f4e170000f7136c617267655f66696c65735f737570706f7274024f4e120000f80f6c617267655f706167655f73697a650130100000f90b6c617267655f7061676573034f4646110000fa0e6c6173745f696e736572745f69640130120000fb0b6c635f6d6573736167657305656e5f55533e0000fc0f6c635f6d657373616765735f6469722d443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c73686172655c140000fd0d6c635f74696d655f6e616d657305656e5f55530c0000fe076c6963656e73650347504c100000ff0c6c6f63616c5f696e66696c65024f4e1b000000116c6f636b5f776169745f74696d656f75740833313533363030300c000001076c6f675f62696e034f464612000002106c6f675f62696e5f626173656e616d65000f0000030d6c6f675f62696e5f696e64657800240000041f6c6f675f62696e5f74727573745f66756e6374696f6e5f63726561746f7273034f46461e000005196c6f675f62696e5f7573655f76315f726f775f6576656e7473034f46462a000006256c6f675f6275696c74696e5f61735f6964656e7469666965645f62795f70617373776f7264034f46464a000007096c6f675f6572726f723f443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362e65727216000008136c6f675f6572726f725f766572626f736974790133100000090a6c6f675f6f75747075740446494c452200000a1d6c6f675f717565726965735f6e6f745f7573696e675f696e6465786573034f46461600000b116c6f675f736c6176655f75706461746573034f46461e00000c196c6f675f736c6f775f61646d696e5f73746174656d656e7473034f46461e00000d196c6f675f736c6f775f736c6176655f73746174656d656e7473034f46462400000e206c6f675f73746174656d656e74735f756e736166655f666f725f62696e6c6f67024f4e0e00000f0a6c6f675f7379736c6f67024f4e100000100e6c6f675f7379736c6f675f7461670029000011266c6f675f7468726f74746c655f717565726965735f6e6f745f7573696e675f696e64657865730130130000120e6c6f675f74696d657374616d7073035554430f0000130c6c6f675f7761726e696e677301321a0000140f6c6f6e675f71756572795f74696d650931302e30303030303019000015146c6f775f7072696f726974795f75706461746573034f46461a000016166c6f7765725f636173655f66696c655f73797374656d024f4e19000017166c6f7765725f636173655f7461626c655f6e616d657301311c000018166d61737465725f696e666f5f7265706f7369746f72790446494c451b000019166d61737465725f7665726966795f636865636b73756d034f46461b00001a126d61785f616c6c6f7765645f7061636b657407343139343330342b00001b156d61785f62696e6c6f675f63616368655f73697a651431383434363734343037333730393534373532301b00001c0f6d61785f62696e6c6f675f73697a650a313037333734313832343000001d1a6d61785f62696e6c6f675f73746d745f63616368655f73697a651431383434363734343037333730393534373532301500001e126d61785f636f6e6e6563745f6572726f727301331300001f0f6d61785f636f6e6e656374696f6e7302313017000020136d61785f64656c617965645f7468726561647302323017000021116d61785f6469676573745f6c656e6774680431303234130000220f6d61785f6572726f725f636f756e7402363415000023126d61785f657865637574696f6e5f74696d6501301d000024136d61785f686561705f7461626c655f73697a650831363737373231361e0000251a6d61785f696e736572745f64656c617965645f74687265616473023230230000260d6d61785f6a6f696e5f73697a651431383434363734343037333730393535313631351e000027186d61785f6c656e6774685f666f725f736f72745f6461746104313032341d000028166d61785f706f696e74735f696e5f67656f6d657472790536353533361e000029176d61785f70726570617265645f73746d745f636f756e740531363338321500002a126d61785f72656c61795f6c6f675f73697a6501301d00002b116d61785f7365656b735f666f725f6b65790a343239343936373239351500002c0f6d61785f736f72745f6c656e67746804313032341900002d166d61785f73705f726563757273696f6e5f646570746801301200002e0e6d61785f746d705f7461626c65730233321700002f146d61785f757365725f636f6e6e656374696f6e73013020000030146d61785f77726974655f6c6f636b5f636f756e740a343239343936373239351f000031196d657461646174615f6c6f636b735f63616368655f73697a650431303234200000321d6d657461646174615f6c6f636b735f686173685f696e7374616e636573013819000033166d696e5f6578616d696e65645f726f775f6c696d6974013016000034116d756c74695f72616e67655f636f756e74033235361b000035186d796973616d5f646174615f706f696e7465725f73697a65013625000036196d796973616d5f6d61785f736f72745f66696c655f73697a650a3231343634333530373226000037106d796973616d5f6d6d61705f73697a651431383434363734343037333730393535313631351b000038166d796973616d5f7265636f7665725f6f7074696f6e73034f464618000039156d796973616d5f7265706169725f7468726561647301312000003a176d796973616d5f736f72745f6275666665725f73697a6507383338383630382200003b136d796973616d5f73746174735f6d6574686f640d6e756c6c735f756e657175616c1400003c0f6d796973616d5f7573655f6d6d6170034f46462600003d216d7973716c5f6e61746976655f70617373776f72645f70726f78795f7573657273034f46460f00003e0a6e616d65645f70697065034f46462800003f1c6e616d65645f706970655f66756c6c5f6163636573735f67726f75700a2a65766572796f6e652a18000040116e65745f6275666665725f6c656e67746805313633383414000041106e65745f726561645f74696d656f7574023330130000420f6e65745f72657472795f636f756e7402313015000043116e65745f77726974655f74696d656f757402363008000044036e6577034f464613000045106e6772616d5f746f6b656e5f73697a650132110000460c6f66666c696e655f6d6f6465034f464608000047036f6c64034f4646140000480f6f6c645f616c7465725f7461626c65034f4646100000490d6f6c645f70617373776f72647301301600004a106f70656e5f66696c65735f6c696d697404373034381800004b156f7074696d697a65725f7072756e655f6c6576656c01311a00004c166f7074696d697a65725f7365617263685f6465707468023632a401004d106f7074696d697a65725f737769746368fc9001696e6465785f6d657267653d6f6e2c696e6465785f6d657267655f756e696f6e3d6f6e2c696e6465785f6d657267655f736f72745f756e696f6e3d6f6e2c696e6465785f6d657267655f696e74657273656374696f6e3d6f6e2c656e67696e655f636f6e646974696f6e5f70757368646f776e3d6f6e2c696e6465785f636f6e646974696f6e5f70757368646f776e3d6f6e2c6d72723d6f6e2c6d72725f636f73745f62617365643d6f6e2c626c6f636b5f6e65737465645f6c6f6f703d6f6e2c626174636865645f6b65795f6163636573733d6f66662c6d6174657269616c697a6174696f6e3d6f6e2c73656d696a6f696e3d6f6e2c6c6f6f73657363616e3d6f6e2c66697273746d617463683d6f6e2c6475706c6963617465776565646f75743d6f6e2c73756271756572795f6d6174657269616c697a6174696f6e5f636f73745f62617365643d6f6e2c7573655f696e6465785f657874656e73696f6e733d6f6e2c636f6e646974696f6e5f66616e6f75745f66696c7465723d6f6e2c646572697665645f6d657267653d6f6e2900004e0f6f7074696d697a65725f747261636518656e61626c65643d6f66662c6f6e655f6c696e653d6f66666400004f186f7074696d697a65725f74726163655f66656174757265734a6772656564795f7365617263683d6f6e2c72616e67655f6f7074696d697a65723d6f6e2c64796e616d69635f72616e67653d6f6e2c72657065617465645f73756273656c6563743d6f6e18000050156f7074696d697a65725f74726163655f6c696d69740131230000511c6f7074696d697a65725f74726163655f6d61785f6d656d5f73697a650531363338341a000052166f7074696d697a65725f74726163655f6f6666736574022d3129000053137061727365725f6d61785f6d656d5f73697a651431383434363734343037333730393535313631351600005412706572666f726d616e63655f736368656d61024f4e2400005520706572666f726d616e63655f736368656d615f6163636f756e74735f73697a65022d31260000561f706572666f726d616e63655f736368656d615f646967657374735f73697a650531303030303900005732706572666f726d616e63655f736368656d615f6576656e74735f7374616765735f686973746f72795f6c6f6e675f73697a65053130303030310000582d706572666f726d616e63655f736368656d615f6576656e74735f7374616765735f686973746f72795f73697a650231303d00005936706572666f726d616e63655f736368656d615f6576656e74735f73746174656d656e74735f686973746f72795f6c6f6e675f73697a650531303030303500005a31706572666f726d616e63655f736368656d615f6576656e74735f73746174656d656e74735f686973746f72795f73697a650231303f00005b38706572666f726d616e63655f736368656d615f6576656e74735f7472616e73616374696f6e735f686973746f72795f6c6f6e675f73697a650531303030303700005c33706572666f726d616e63655f736368656d615f6576656e74735f7472616e73616374696f6e735f686973746f72795f73697a650231303800005d31706572666f726d616e63655f736368656d615f6576656e74735f77616974735f686973746f72795f6c6f6e675f73697a650531303030303000005e2c706572666f726d616e63655f736368656d615f6576656e74735f77616974735f686973746f72795f73697a650231302100005f1d706572666f726d616e63655f736368656d615f686f7374735f73697a65022d312700006023706572666f726d616e63655f736368656d615f6d61785f636f6e645f636c61737365730238302900006125706572666f726d616e63655f736368656d615f6d61785f636f6e645f696e7374616e636573022d312a00006224706572666f726d616e63655f736368656d615f6d61785f6469676573745f6c656e67746804313032342700006323706572666f726d616e63655f736368656d615f6d61785f66696c655f636c61737365730238302a00006423706572666f726d616e63655f736368656d615f6d61785f66696c655f68616e646c65730533323736382900006525706572666f726d616e63655f736368656d615f6d61785f66696c655f696e7374616e636573022d312500006621706572666f726d616e63655f736368656d615f6d61785f696e6465785f73746174022d312a00006725706572666f726d616e63655f736368656d615f6d61785f6d656d6f72795f636c6173736573033332302900006825706572666f726d616e63655f736368656d615f6d61785f6d657461646174615f6c6f636b73022d312900006924706572666f726d616e63655f736368656d615f6d61785f6d757465785f636c6173736573033231302a00006a26706572666f726d616e63655f736368656d615f6d61785f6d757465785f696e7374616e636573022d313800006b34706572666f726d616e63655f736368656d615f6d61785f70726570617265645f73746174656d656e74735f696e7374616e636573022d312c00006c28706572666f726d616e63655f736368656d615f6d61785f70726f6772616d5f696e7374616e636573022d312900006d25706572666f726d616e63655f736368656d615f6d61785f72776c6f636b5f636c61737365730235302b00006e27706572666f726d616e63655f736368656d615f6d61785f72776c6f636b5f696e7374616e636573022d312900006f25706572666f726d616e63655f736368656d615f6d61785f736f636b65745f636c61737365730231302b00007027706572666f726d616e63655f736368656d615f6d61785f736f636b65745f696e7374616e636573022d312c00007126706572666f726d616e63655f736368656d615f6d61785f73716c5f746578745f6c656e67746804313032342900007224706572666f726d616e63655f736368656d615f6d61785f73746167655f636c6173736573033135302d00007328706572666f726d616e63655f736368656d615f6d61785f73746174656d656e745f636c6173736573033139332a00007426706572666f726d616e63655f736368656d615f6d61785f73746174656d656e745f737461636b0231302800007524706572666f726d616e63655f736368656d615f6d61785f7461626c655f68616e646c6573022d312a00007626706572666f726d616e63655f736368656d615f6d61785f7461626c655f696e7374616e636573022d312a00007726706572666f726d616e63655f736368656d615f6d61785f7461626c655f6c6f636b5f73746174022d312900007825706572666f726d616e63655f736368656d615f6d61785f7468726561645f636c61737365730235302b00007927706572666f726d616e63655f736368656d615f6d61785f7468726561645f696e7374616e636573022d313200007a2d706572666f726d616e63655f736368656d615f73657373696f6e5f636f6e6e6563745f61747472735f73697a65033531322800007b24706572666f726d616e63655f736368656d615f73657475705f6163746f72735f73697a65022d312900007c25706572666f726d616e63655f736368656d615f73657475705f6f626a656374735f73697a65022d312100007d1d706572666f726d616e63655f736368656d615f75736572735f73697a65022d314900007e087069645f66696c653f443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362e7069643e00007f0a706c7567696e5f64697232443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c6c69625c706c7567696e5c0a00008004706f727404333330361a000081137072656c6f61645f6275666665725f73697a650533323736380e0000820970726f66696c696e67034f46461a0000831670726f66696c696e675f686973746f72795f73697a65023135140000841070726f746f636f6c5f76657273696f6e0231300c0000850a70726f78795f7573657200160000861170736575646f5f736c6176655f6d6f6465034f4646130000871070736575646f5f7468726561645f696401331c0000881671756572795f616c6c6f635f626c6f636b5f73697a6504383139321a0000891171756572795f63616368655f6c696d697407313034383537361e00008a1871756572795f63616368655f6d696e5f7265735f756e697404343039361900008b1071756572795f63616368655f73697a6507313034383537361500008c1071756572795f63616368655f74797065034f46462100008d1c71756572795f63616368655f776c6f636b5f696e76616c6964617465034f46461900008e1371756572795f707265616c6c6f635f73697a6504383139320d00008f0a72616e645f736565643101300d0000900a72616e645f736565643201301c0000911672616e67655f616c6c6f635f626c6f636b5f73697a650434303936250000921c72616e67655f6f7074696d697a65725f6d61785f6d656d5f73697a650738333838363038150000930d7262725f657865635f6d6f6465065354524943541800009410726561645f6275666665725f73697a65063133313037320e00009509726561645f6f6e6c79034f46461c00009614726561645f726e645f6275666665725f73697a65063236323134340b0000970972656c61795f6c6f6700590000981272656c61795f6c6f675f626173656e616d6545443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362d72656c61792d62696e5c0000990f72656c61795f6c6f675f696e6465784b443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362d72656c61792d62696e2e696e6465782300009a1372656c61795f6c6f675f696e666f5f66696c650e72656c61792d6c6f672e696e666f1f00009b1972656c61795f6c6f675f696e666f5f7265706f7369746f72790446494c451300009c0f72656c61795f6c6f675f7075726765024f4e1700009d1272656c61795f6c6f675f7265636f76657279034f46461800009e1572656c61795f6c6f675f73706163655f6c696d697401300d00009f0b7265706f72745f686f737400110000a00f7265706f72745f70617373776f726400110000a10b7265706f72745f706f727404333330360d0000a20b7265706f72745f75736572001d0000a318726571756972655f7365637572655f7472616e73706f7274034f4646200000a41672706c5f73746f705f736c6176655f74696d656f75740833313533363030300f0000a50b7365637572655f61757468024f4e160000a6107365637572655f66696c655f70726976044e554c4c0c0000a7097365727665725f69640130120000a80e7365727665725f69645f62697473023332310000a90b7365727665725f757569642461653061386563342d366663312d313165392d383231612d346363633661346437333434180000aa1373657373696f6e5f747261636b5f6774696473034f4646180000ab1473657373696f6e5f747261636b5f736368656d61024f4e1f0000ac1a73657373696f6e5f747261636b5f73746174655f6368616e6765034f4646780000ad1e73657373696f6e5f747261636b5f73797374656d5f7661726961626c65735874696d655f7a6f6e652c6175746f636f6d6d69742c6368617261637465725f7365745f636c69656e742c6368617261637465725f7365745f726573756c74732c6368617261637465725f7365745f636f6e6e656374696f6e230000ae1e73657373696f6e5f747261636b5f7472616e73616374696f6e5f696e666f034f4646200000af1b7368613235365f70617373776f72645f70726f78795f7573657273034f4646120000b00d7368617265645f6d656d6f7279034f46461e0000b1177368617265645f6d656d6f72795f626173655f6e616d65054d5953514c1a0000b21573686f775f636f6d7061746962696c6974795f3536034f4646200000b31b73686f775f6372656174655f7461626c655f766572626f73697479034f4646170000b41273686f775f6f6c645f74656d706f72616c73034f4646190000b515736b69705f65787465726e616c5f6c6f636b696e67024f4e160000b611736b69705f6e616d655f7265736f6c7665034f4646140000b70f736b69705f6e6574776f726b696e67034f4646170000b812736b69705f73686f775f6461746162617365034f4646190000b914736c6176655f616c6c6f775f6261746368696e67034f46461b0000ba16736c6176655f636865636b706f696e745f67726f7570033531321c0000bb17736c6176655f636865636b706f696e745f706572696f64033330301e0000bc19736c6176655f636f6d707265737365645f70726f746f636f6c034f4646170000bd0f736c6176655f657865635f6d6f646506535452494354350000be11736c6176655f6c6f61645f746d7064697222433a5c55736572735c4a61727669735c417070446174615c4c6f63616c5c54656d70240000bf18736c6176655f6d61785f616c6c6f7765645f7061636b65740a31303733373431383234150000c011736c6176655f6e65745f74696d656f75740236301d0000c113736c6176655f706172616c6c656c5f74797065084441544142415345190000c216736c6176655f706172616c6c656c5f776f726b6572730130250000c31b736c6176655f70656e64696e675f6a6f62735f73697a655f6d6178083136373737323136200000c41b736c6176655f70726573657276655f636f6d6d69745f6f72646572034f4646330000c51c736c6176655f726f77735f7365617263685f616c676f726974686d73155441424c455f5343414e2c494e4445585f5343414e160000c611736c6176655f736b69705f6572726f7273034f46461d0000c719736c6176655f73716c5f7665726966795f636865636b73756d024f4e1d0000c819736c6176655f7472616e73616374696f6e5f72657472696573023130180000c916736c6176655f747970655f636f6e76657273696f6e7300130000ca10736c6f775f6c61756e63685f74696d650132130000cb0e736c6f775f71756572795f6c6f67034f4646590000cc13736c6f775f71756572795f6c6f675f66696c6544443a5c70687073747564795f70726f5c457874656e73696f6e735c4d7953514c352e372e32365c646174615c4445534b544f502d4f37324e5439362d736c6f772e6c6f670d0000cd06736f636b6574054d7953514c180000ce10736f72745f6275666665725f73697a6506323632313434150000cf1073716c5f6175746f5f69735f6e756c6c034f4646130000d00f73716c5f6269675f73656c65637473024f4e160000d11173716c5f6275666665725f726573756c74034f46460f0000d20b73716c5f6c6f675f62696e024f4e100000d30b73716c5f6c6f675f6f6666034f4646930000d40873716c5f6d6f6465894f4e4c595f46554c4c5f47524f55505f42592c5354524943545f5452414e535f5441424c45532c4e4f5f5a45524f5f494e5f444154452c4e4f5f5a45524f5f444154452c4552524f525f464f525f4449564953494f4e5f42595f5a45524f2c4e4f5f4155544f5f4352454154455f555345522c4e4f5f454e47494e455f535542535449545554494f4e0d0000d50973716c5f6e6f746573024f4e190000d61573716c5f71756f74655f73686f775f637265617465024f4e150000d71073716c5f736166655f75706461746573034f4646260000d81073716c5f73656c6563745f6c696d6974143138343436373434303733373039353531363135190000d91673716c5f736c6176655f736b69705f636f756e7465720130110000da0c73716c5f7761726e696e6773034f4646080000db0673736c5f6361000c0000dc0a73736c5f636170617468000a0000dd0873736c5f63657274000c0000de0a73736c5f63697068657200090000df";

    public static String showVariablesRes2 = "0773736c5f63726c000d0000e00b73736c5f63726c7061746800090000e10773736c5f6b657900190000e21473746f7265645f70726f6772616d5f636163686503323536140000e30f73757065725f726561645f6f6e6c79034f46460e0000e40b73796e635f62696e6c6f6701310c0000e50873796e635f66726d024f4e170000e61073796e635f6d61737465725f696e666f053130303030150000e70e73796e635f72656c61795f6c6f670531303030301a0000e81373796e635f72656c61795f6c6f675f696e666f053130303030120000e91073797374656d5f74696d655f7a6f6e65001c0000ea167461626c655f646566696e6974696f6e5f63616368650431343030160000eb107461626c655f6f70656e5f636163686504323030301e0000ec1a7461626c655f6f70656e5f63616368655f696e7374616e636573023136140000ed117468726561645f63616368655f73697a6501382a0000ee0f7468726561645f68616e646c696e67196f6e652d7468726561642d7065722d636f6e6e656374696f6e140000ef0c7468726561645f737461636b06323632313434150000f00b74696d655f666f726d61740825483a25693a2573110000f10974696d655f7a6f6e650653595354454d1c0000f20974696d657374616d7011313638333731383631392e3237353639301a0000f30b746c735f76657273696f6e0d544c5376312c544c5376312e31180000f40e746d705f7461626c655f73697a650831363737373231362a0000f506746d7064697222433a5c55736572735c4a61727669735c417070446174615c4c6f63616c5c54656d70220000f61c7472616e73616374696f6e5f616c6c6f635f626c6f636b5f73697a6504383139321f0000f71a7472616e73616374696f6e5f616c6c6f775f6261746368696e67034f4646260000f8157472616e73616374696f6e5f69736f6c6174696f6e0f52455045415441424c452d524541441f0000f9197472616e73616374696f6e5f707265616c6c6f635f73697a6504343039361a0000fa157472616e73616374696f6e5f726561645f6f6e6c79034f4646250000fb207472616e73616374696f6e5f77726974655f7365745f65787472616374696f6e034f46461d0000fc0c74785f69736f6c6174696f6e0f52455045415441424c452d52454144110000fd0c74785f726561645f6f6e6c79034f4646110000fe0d756e697175655f636865636b73024f4e1f0000ff1a757064617461626c655f76696577735f776974685f6c696d6974035945530f0000000776657273696f6e06352e372e32362d0000010f76657273696f6e5f636f6d6d656e741c4d7953514c20436f6d6d756e69747920536572766572202847504c291f0000021776657273696f6e5f636f6d70696c655f6d616368696e65067838365f3634190000031276657273696f6e5f636f6d70696c655f6f730557696e3634130000040c776169745f74696d656f7574053238383030100000050d7761726e696e675f636f756e74013005000006fe01002200";

    public static String showWarnings = "53484f57205741524e494e4753";
    public static String showWarningsRes = "01000001031b00000203646566000000054c6576656c000c080007000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c080000020000fd01001f000005000005fe000002006a000006075761726e696e6704313336365c496e636f727265637420737472696e672076616c75653a20275c7844365c7844305c7842395c7846415c7842315c7845412e2e2e2720666f7220636f6c756d6e20275641524941424c455f56414c55452720617420726f772034383505000007fe00000200";

    public static String showCollation = "53484f5720434f4c4c4154494f4e";
    public static String showCollationRes = "0100000106530000020364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e5309436f6c6c6174696f6e0e434f4c4c4154494f4e5f4e414d450c080020000000fd0100000000550000030364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e530743686172736574124348415241435445525f5345545f4e414d450c080020000000fd0100000000400000040364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e530249640249440c3f000b0000000801000000004d0000050364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e530744656661756c740a49535f44454641554c540c080003000000fd01000000004f0000060364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e5308436f6d70696c65640b49535f434f4d50494c45440c080003000000fd01000000004a0000070364656612696e666f726d6174696f6e5f736368656d610a434f4c4c4154494f4e530a434f4c4c4154494f4e5307536f72746c656e07534f52544c454e0c3f000300000008010000000005000008fe00002200210000090f626967355f6368696e6573655f636904626967350131035965730359657301311800000a08626967355f62696e0462696735023834000359657301312100000b0f646563385f737765646973685f636904646563380133035965730359657301311800000c08646563385f62696e0464656338023639000359657301312300000d1063703835305f67656e6572616c5f63690563703835300134035965730359657301311a00000e0963703835305f62696e056370383530023830000359657301311f00000f0e6870385f656e676c6973685f63690368703801360359657303596573013116000010076870385f62696e036870380237320003596573013123000011106b6f6938725f67656e6572616c5f6369056b6f6938720137035965730359657301311a000012096b6f6938725f62696e056b6f6938720237340003596573013122000013116c6174696e315f6765726d616e315f6369066c6174696e3101350003596573013125000014116c6174696e315f737765646973685f6369066c6174696e3101380359657303596573013122000015106c6174696e315f64616e6973685f6369066c6174696e310231350003596573013123000016116c6174696e315f6765726d616e325f6369066c6174696e31023331000359657301321c0000170a6c6174696e315f62696e066c6174696e310234370003596573013123000018116c6174696e315f67656e6572616c5f6369066c6174696e310234380003596573013123000019116c6174696e315f67656e6572616c5f6373066c6174696e31023439000359657301312300001a116c6174696e315f7370616e6973685f6369066c6174696e31023934000359657301312000001b0f6c6174696e325f637a6563685f6373066c6174696e320132000359657301342500001c116c6174696e325f67656e6572616c5f6369066c6174696e320139035965730359657301312500001d136c6174696e325f68756e67617269616e5f6369066c6174696e32023231000359657301312400001e126c6174696e325f63726f617469616e5f6369066c6174696e32023237000359657301311c00001f0a6c6174696e325f62696e066c6174696e3202373700035965730131220000200f737765375f737765646973685f63690473776537023130035965730359657301311800002108737765375f62696e047377653702383200035965730131240000221061736369695f67656e6572616c5f6369056173636969023131035965730359657301311a0000230961736369695f62696e056173636969023635000359657301312300002410756a69735f6a6170616e6573655f636904756a6973023132035965730359657301311800002508756a69735f62696e04756a6973023931000359657301312300002610736a69735f6a6170616e6573655f636904736a6973023133035965730359657301311800002708736a69735f62696e04736a69730238380003596573013126000028116865627265775f67656e6572616c5f636906686562726577023136035965730359657301311c0000290a6865627265775f62696e06686562726577023731000359657301312300002a0e7469733632305f746861695f636906746973363230023138035965730359657301341c00002b0a7469733632305f62696e06746973363230023839000359657301312300002c0f6575636b725f6b6f7265616e5f6369056575636b72023139035965730359657301311a00002d096575636b725f62696e056575636b72023835000359657301312400002e106b6f6938755f67656e6572616c5f6369056b6f693875023232035965730359657301311a00002f096b6f6938755f62696e056b6f6938750237350003596573013126000030116762323331325f6368696e6573655f636906676232333132023234035965730359657301311c0000310a6762323331325f62696e06676232333132023836000359657301312400003210677265656b5f67656e6572616c5f636905677265656b023235035965730359657301311a00003309677265656b5f62696e05677265656b0237300003596573013126000034116370313235305f67656e6572616c5f63690663703132353002323603596573035965730131210000350f6370313235305f637a6563685f6373066370313235300233340003596573013224000036126370313235305f63726f617469616e5f636906637031323530023434000359657301311c0000370a6370313235305f62696e066370313235300236360003596573013122000038106370313235305f706f6c6973685f63690663703132353002393900035965730131200000390e67626b5f6368696e6573655f63690367626b023238035965730359657301311600003a0767626b5f62696e0367626b023837000359657301312600003b116c6174696e355f7475726b6973685f6369066c6174696e35023330035965730359657301311c00003c0a6c6174696e355f62696e066c6174696e35023738000359657301312a00003d1361726d73636969385f67656e6572616c5f63690861726d7363696938023332035965730359657301312000003e0c61726d73636969385f62696e0861726d7363696938023634000359657301312200003f0f757466385f67656e6572616c5f63690475746638023333035965730359657301311800004008757466385f62696e047574663802383300035965730131200000410f757466385f756e69636f64655f6369047574663803313932000359657301382200004211757466385f6963656c616e6469635f636904757466380331393300035965730138200000430f757466385f6c61747669616e5f6369047574663803313934000359657301382100004410757466385f726f6d616e69616e5f6369047574663803313935000359657301382200004511757466385f736c6f76656e69616e5f6369047574663803313936000359657301381f0000460e757466385f706f6c6973685f6369047574663803313937000359657301382100004710757466385f6573746f6e69616e5f636904757466380331393800035965730138200000480f757466385f7370616e6973685f636904757466380331393900035965730138200000490f757466385f737765646973685f6369047574663803323030000359657301382000004a0f757466385f7475726b6973685f6369047574663803323031000359657301381e00004b0d757466385f637a6563685f6369047574663803323032000359657301381f00004c0e757466385f64616e6973685f6369047574663803323033000359657301382300004d12757466385f6c69746875616e69616e5f6369047574663803323034000359657301381f00004e0e757466385f736c6f76616b5f6369047574663803323035000359657301382100004f10757466385f7370616e697368325f6369047574663803323036000359657301381e0000500d757466385f726f6d616e5f636904757466380332303700035965730138200000510f757466385f7065727369616e5f6369047574663803323038000359657301382200005211757466385f6573706572616e746f5f6369047574663803323039000359657301382200005311757466385f68756e67617269616e5f636904757466380332313000035965730138200000540f757466385f73696e68616c615f636904757466380332313100035965730138200000550f757466385f6765726d616e325f6369047574663803323132000359657301382100005610757466385f63726f617469616e5f6369047574663803323133000359657301382400005713757466385f756e69636f64655f3532305f6369047574663803323134000359657301382300005812757466385f766965746e616d6573655f6369047574663803323135000359657301382900005918757466385f67656e6572616c5f6d7973716c3530305f6369047574663803323233000359657301312200005a0f756373325f67656e6572616c5f63690475637332023335035965730359657301311800005b08756373325f62696e0475637332023930000359657301312000005c0f756373325f756e69636f64655f6369047563733203313238000359657301382200005d11756373325f6963656c616e6469635f6369047563733203313239000359657301382000005e0f756373325f6c61747669616e5f6369047563733203313330000359657301382100005f10756373325f726f6d616e69616e5f6369047563733203313331000359657301382200006011756373325f736c6f76656e69616e5f6369047563733203313332000359657301381f0000610e756373325f706f6c6973685f6369047563733203313333000359657301382100006210756373325f6573746f6e69616e5f636904756373320331333400035965730138200000630f756373325f7370616e6973685f636904756373320331333500035965730138200000640f756373325f737765646973685f636904756373320331333600035965730138200000650f756373325f7475726b6973685f6369047563733203313337000359657301381e0000660d756373325f637a6563685f6369047563733203313338000359657301381f0000670e756373325f64616e6973685f6369047563733203313339000359657301382300006812756373325f6c69746875616e69616e5f6369047563733203313430000359657301381f0000690e756373325f736c6f76616b5f6369047563733203313431000359657301382100006a10756373325f7370616e697368325f6369047563733203313432000359657301381e00006b0d756373325f726f6d616e5f6369047563733203313433000359657301382000006c0f756373325f7065727369616e5f6369047563733203313434000359657301382200006d11756373325f6573706572616e746f5f6369047563733203313435000359657301382200006e11756373325f68756e67617269616e5f6369047563733203313436000359657301382000006f0f756373325f73696e68616c615f636904756373320331343700035965730138200000700f756373325f6765726d616e325f6369047563733203313438000359657301382100007110756373325f63726f617469616e5f6369047563733203313439000359657301382400007213756373325f756e69636f64655f3532305f6369047563733203313530000359657301382300007312756373325f766965746e616d6573655f6369047563733203313531000359657301382900007418756373325f67656e6572616c5f6d7973716c3530305f636904756373320331353900035965730131240000751063703836365f67656e6572616c5f6369056370383636023336035965730359657301311a0000760963703836365f62696e0563703836360236380003596573013128000077126b6579626373325f67656e6572616c5f6369076b657962637332023337035965730359657301311e0000780b6b6579626373325f62696e076b6579626373320237330003596573013124000079106d616363655f67656e6572616c5f6369056d61636365023338035965730359657301311a00007a096d616363655f62696e056d61636365023433000359657301312a00007b136d6163726f6d616e5f67656e6572616c5f6369086d6163726f6d616e023339035965730359657301312000007c0c6d6163726f6d616e5f62696e086d6163726f6d616e023533000359657301312400007d1063703835325f67656e6572616c5f6369056370383532023430035965730359657301311a00007e0963703835325f62696e056370383532023831000359657301312400007f126c6174696e375f6573746f6e69616e5f6373066c6174696e370232300003596573013126000080116c6174696e375f67656e6572616c5f6369066c6174696e370234310359657303596573013123000081116c6174696e375f67656e6572616c5f6373066c6174696e37023432000359657301311c0000820a6c6174696e375f62696e066c6174696e37023739000359657301312800008312757466386d62345f67656e6572616c5f636907757466386d6234023435035965730359657301311e0000840b757466386d62345f62696e07757466386d6234023436000359657301312600008512757466386d62345f756e69636f64655f636907757466386d623403323234000359657301382800008614757466386d62345f6963656c616e6469635f636907757466386d623403323235000359657301382600008712757466386d62345f6c61747669616e5f636907757466386d623403323236000359657301382700008813757466386d62345f726f6d616e69616e5f636907757466386d623403323237000359657301382800008914757466386d62345f736c6f76656e69616e5f636907757466386d623403323238000359657301382500008a11757466386d62345f706f6c6973685f636907757466386d623403323239000359657301382700008b13757466386d62345f6573746f6e69616e5f636907757466386d623403323330000359657301382600008c12757466386d62345f7370616e6973685f636907757466386d623403323331000359657301382600008d12757466386d62345f737765646973685f636907757466386d623403323332000359657301382600008e12757466386d62345f7475726b6973685f636907757466386d623403323333000359657301382400008f10757466386d62345f637a6563685f636907757466386d623403323334000359657301382500009011757466386d62345f64616e6973685f636907757466386d623403323335000359657301382900009115757466386d62345f6c69746875616e69616e5f636907757466386d623403323336000359657301382500009211757466386d62345f736c6f76616b5f636907757466386d623403323337000359657301382700009313757466386d62345f7370616e697368325f636907757466386d623403323338000359657301382400009410757466386d62345f726f6d616e5f636907757466386d623403323339000359657301382600009512757466386d62345f7065727369616e5f636907757466386d623403323430000359657301382800009614757466386d62345f6573706572616e746f5f636907757466386d623403323431000359657301382800009714757466386d62345f68756e67617269616e5f636907757466386d623403323432000359657301382600009812757466386d62345f73696e68616c615f636907757466386d623403323433000359657301382600009912757466386d62345f6765726d616e325f636907757466386d623403323434000359657301382700009a13757466386d62345f63726f617469616e5f636907757466386d623403323435000359657301382a00009b16757466386d62345f756e69636f64655f3532305f636907757466386d623403323436000359657301382900009c15757466386d62345f766965746e616d6573655f636907757466386d623403323437000359657301382500009d136370313235315f62756c67617269616e5f636906637031323531023134000359657301312500009e136370313235315f756b7261696e69616e5f636906637031323531023233000359657301311c00009f0a6370313235315f62696e0663703132353102353000035965730131260000a0116370313235315f67656e6572616c5f63690663703132353102353103596573035965730131230000a1116370313235315f67656e6572616c5f63730663703132353102353200035965730131240000a21075746631365f67656e6572616c5f6369057574663136023534035965730359657301311a0000a30975746631365f62696e05757466313602353500035965730131220000a41075746631365f756e69636f64655f63690575746631360331303100035965730138240000a51275746631365f6963656c616e6469635f63690575746631360331303200035965730138220000a61075746631365f6c61747669616e5f63690575746631360331303300035965730138230000a71175746631365f726f6d616e69616e5f63690575746631360331303400035965730138240000a81275746631365f736c6f76656e69616e5f63690575746631360331303500035965730138210000a90f75746631365f706f6c6973685f63690575746631360331303600035965730138230000aa1175746631365f6573746f6e69616e5f63690575746631360331303700035965730138220000ab1075746631365f7370616e6973685f63690575746631360331303800035965730138220000ac1075746631365f737765646973685f63690575746631360331303900035965730138220000ad1075746631365f7475726b6973685f63690575746631360331313000035965730138200000ae0e75746631365f637a6563685f63690575746631360331313100035965730138210000af0f75746631365f64616e6973685f63690575746631360331313200035965730138250000b01375746631365f6c69746875616e69616e5f63690575746631360331313300035965730138210000b10f75746631365f736c6f76616b5f63690575746631360331313400035965730138230000b21175746631365f7370616e697368325f63690575746631360331313500035965730138200000b30e75746631365f726f6d616e5f63690575746631360331313600035965730138220000b41075746631365f7065727369616e5f63690575746631360331313700035965730138240000b51275746631365f6573706572616e746f5f63690575746631360331313800035965730138240000b61275746631365f68756e67617269616e5f63690575746631360331313900035965730138220000b71075746631365f73696e68616c615f63690575746631360331323000035965730138220000b81075746631365f6765726d616e325f63690575746631360331323100035965730138230000b91175746631365f63726f617469616e5f63690575746631360331323200035965730138260000ba1475746631365f756e69636f64655f3532305f63690575746631360331323300035965730138250000bb1375746631365f766965746e616d6573655f63690575746631360331323400035965730138280000bc1275746631366c655f67656e6572616c5f63690775746631366c65023536035965730359657301311e0000bd0b75746631366c655f62696e0775746631366c6502363200035965730131260000be116370313235365f67656e6572616c5f636906637031323536023537035965730359657301311c0000bf0a6370313235365f62696e0663703132353602363700035965730131260000c0146370313235375f6c69746875616e69616e5f636906637031323537023239000359657301311c0000c10a6370313235375f62696e0663703132353702353800035965730131260000c2116370313235375f67656e6572616c5f63690663703132353702353903596573035965730131240000c31075746633325f67656e6572616c5f6369057574663332023630035965730359657301311a0000c40975746633325f62696e05757466333202363100035965730131220000c51075746633325f756e69636f64655f63690575746633320331363000035965730138240000c61275746633325f6963656c616e6469635f63690575746633320331363100035965730138220000c71075746633325f6c61747669616e5f63690575746633320331363200035965730138230000c81175746633325f726f6d616e69616e5f63690575746633320331363300035965730138240000c91275746633325f736c6f76656e69616e5f63690575746633320331363400035965730138210000ca0f75746633325f706f6c6973685f63690575746633320331363500035965730138230000cb1175746633325f6573746f6e69616e5f63690575746633320331363600035965730138220000cc1075746633325f7370616e6973685f63690575746633320331363700035965730138220000cd1075746633325f737765646973685f63690575746633320331363800035965730138220000ce1075746633325f7475726b6973685f63690575746633320331363900035965730138200000cf0e75746633325f637a6563685f63690575746633320331373000035965730138210000d00f75746633325f64616e6973685f63690575746633320331373100035965730138250000d11375746633325f6c69746875616e69616e5f63690575746633320331373200035965730138210000d20f75746633325f736c6f76616b5f63690575746633320331373300035965730138230000d31175746633325f7370616e697368325f63690575746633320331373400035965730138200000d40e75746633325f726f6d616e5f63690575746633320331373500035965730138220000d51075746633325f7065727369616e5f63690575746633320331373600035965730138240000d61275746633325f6573706572616e746f5f63690575746633320331373700035965730138240000d71275746633325f68756e67617269616e5f63690575746633320331373800035965730138220000d81075746633325f73696e68616c615f63690575746633320331373900035965730138220000d91075746633325f6765726d616e325f63690575746633320331383000035965730138230000da1175746633325f63726f617469616e5f63690575746633320331383100035965730138260000db1475746633325f756e69636f64655f3532305f63690575746633320331383200035965730138250000dc1375746633325f766965746e616d6573655f636905757466333203313833000359657301381b0000dd0662696e6172790662696e61727902363303596573035965730131280000de1267656f737464385f67656e6572616c5f63690767656f73746438023932035965730359657301311e0000df0b67656f737464385f62696e0767656f7374643802393300035965730131250000e01163703933325f6a6170616e6573655f6369056370393332023935035965730359657301311a0000e10963703933325f62696e05637039333202393600035965730131290000e2136575636a706d735f6a6170616e6573655f6369076575636a706d73023937035965730359657301311e0000e30b6575636a706d735f62696e076575636a706d7302393800035965730131290000e412676231383033305f6368696e6573655f6369076762313830333003323438035965730359657301321f0000e50b676231383033305f62696e076762313830333003323439000359657301312a0000e616676231383033305f756e69636f64655f3532305f636907676231383033300332353000035965730138050000e7fe00002200";

    public static String setNameUtf8mb4 = "534554204e414d455320757466386d6234";
    public static String setNameUtf8 = "534554204e414d45532075746638";

    public static String maxAllowedPacket = "53454c4543542040406d61785f616c6c6f7765645f7061636b6574";

    public static String maxAllowedPacketRes = "01000001012a000002036465660000001440406d61785f616c6c6f7765645f7061636b6574000c3f001500000008a00000000005000003fe0000020008000004073431393433303405000005fe00000200";

    // 可选版本集合,已有:8.0.12 ,5.0.97 , 5.5.29
    public static String[] versionList =
            {"352e372e323600", "382e302e313200", "352e302e393700", "352e352e323900"};

    // 已选版本
    public static String choiceVersion;

    // 数据包长度
    public static String packetLength = "";
    // 客户端ip,格式为packet中byte
    public static String clientIp = "";
    public static String errorCode1129 = "";

    public static String errorCode1045 = "";

    /**
     * 获取本机的hostname,用于蜜罐伪造
     */
    private static String getHost() {
        String command = "whoami"; // 要执行的系统命令

        try {
            ProcessBuilder builder = new ProcessBuilder(command);
            builder.redirectErrorStream(true);
            Process process = builder.start();

            InputStream inputStream = process.getInputStream();
            BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream));

            String line;
            StringBuilder output = new StringBuilder();
            while ((line = reader.readLine()) != null) {
                output.append(line).append("\n");
            }
            process.waitFor(); // 等待进程结束并获取退出码
            String host = output.toString();
            if (host.contains(File.separator)) {
                host = host.substring(0, host.lastIndexOf(File.separator));
            }
            output.setLength(0);
            byte[] bytes = host.toUpperCase().getBytes(StandardCharsets.UTF_8);
            for (byte b : bytes) {
                output.append(String.format("%02X", b));
            }
            return output.toString();
        } catch (Exception ignored) {
        }
        return "";
    }


    /**
     * 生成PacketLength
     */
    private static void generatePacketLength(int packetLengthByInt) {
        String tmpStr1;
        String[] tmpStr2 = new String[4];
        StringBuilder middleStr = new StringBuilder();
        if (packetLengthByInt <= 255) {
            middleStr.append(String.format("%02x", packetLengthByInt)).append("0000");
        } else if (packetLengthByInt <= 65280) {
            tmpStr1 = String.format("%04x", packetLengthByInt);
            for (int i = 0; i < 2; i++) {
                tmpStr2[i] = tmpStr1.substring(i, i + 2);
            }
            middleStr.append(tmpStr2[1]).append(tmpStr2[0]).append("0000");
        } else if (packetLengthByInt <= 16711680) {
            tmpStr1 = String.format("%06x", packetLengthByInt);
            for (int i = 0; i < 3; i++) {
                tmpStr2[i] = tmpStr1.substring(i, i + 2);
            }
            middleStr.append(tmpStr2[2]).append(tmpStr2[1]).append(tmpStr2[0]).append("0000");

        }
        packetLength = middleStr.toString();
    }

    /**
     * 登录失败时返回的error code
     */
    public static void return1045(DataOutputStream out, String ip) throws IOException {
        errorCode1045 = "02ff15042332383030304163636573732064656e69656420666f7220757365722027";
        errorCode1045 = errorCode1045 + stringUtils.byteArrayToHex(Socket.usernameByte) + "274027";
        String host;
        if (ip.equals("127.0.0.1")) {
            host = "6c6f63616c686f7374";
        } else {
            host = getHost();
        }
        errorCode1045 = errorCode1045 + host + "2720287573696e672070617373776f72643a20";

        String havePassword; // have password?
        if (Socket.isHavePassword) {
            havePassword = "594553";
        } else {
            havePassword = "4e4f";
        }

        errorCode1045 = errorCode1045 + havePassword + "29";
        generatePacketLength((errorCode1045.length() / 2) - 1);
        errorCode1045 = packetLength + errorCode1045;
        out.write(stringUtils.hexToByteArray(errorCode1045));
        out.flush();
    }

    /**
     * 只要连接出错了,返回一个1129错误码
     */
    public static void return1129(DataOutputStream out, String ip) throws IOException {
        // 1-1.生成packet Length
        int totalLength = 98 + ip.length() - 4;
        generatePacketLength(totalLength);

        // 1-2.生成clientIp,将clientIp转换为对应byte,如 "10." 转为 => "31302e"
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < ip.length(); i++) {
            sb.append(Integer.toHexString(ip.charAt(i)));
        }
        clientIp = sb.toString();

        // 1-3.out.write(1129 Error Code);
        errorCode1129 = packetLength + "00ff6904486f73742027" + clientIp + "2720697320626c6f636b65642062656361757365206f66206d616e7920636f6e6e656374696f6e206572726f72733b20756e626c6f636b207769746820276d7973716c61646d696e20666c7573682d686f73747327";
        out.write(stringUtils.hexToByteArray(errorCode1129));
    }

    public static String flushVersionText() throws IOException {
        randomSaltValue = random.randomSalt();
        return "4a0000000a" + choiceVersion + random.randomThreadIdIncrease() + randomSaltValue.substring(0, 16) + "00ffffc00200ffc31500000000000000000000" + randomSaltValue.substring(16) + "006d7973716c5f6e61746976655f70617373776f726400";
    }

}
